<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <!-- CSS base -->
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/theme-soft-light.v1.css">
  <link rel="stylesheet" href="css/nav-ribbon.v5.css"><!-- os botões novos -->

  <!-- Versão + branding -->
  <script>window.IDMAR_VERSION="Vs 1.3";</script>
  <script defer src="js/idmar-config.v4.js"></script>

  <!-- Header/i18n (core) -->
  <script defer src="js/idmar-i18n.js"></script>
  <script defer src="js/idmar-header-only.all.v4.js"></script>

  <!-- Overrides -->
  <script defer src="js/header-override.v4.js"></script>
  <script defer src="js/i18n-boot.js"></script>
  <script defer src="js/idmar-version.v4.js"></script>
  

  <!-- Bilingue PT/EN para a página Forense -->
  <script defer src="js/forense-bilingual.v2.js"></script>

<link rel="icon" href="img/logo-pm.png">
</head>

<body>
  <!-- header é injetado por JS -->

  <main class="container">
    <h1>Forense — Índice</h1>

    <section class="panel">
      <h2>Carregar evidências</h2>
      <div class="row" style="display:flex;gap:.5rem;flex-wrap:wrap">
        <input id="evPhotos" type="file" accept="image/*" multiple />
        <select id="evContext">
          <option value="win">Contexto: WIN/HIN</option>
          <option value="motor">Contexto: Motor</option>
        </select>
        <button id="evAttach">Anexar ao histórico mais recente</button>
      </div>
      <div id="evMeta" class="meta" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:.5rem;margin-top:.5rem"></div>
      <div id="evThumbs" class="thumbs" style="display:flex;gap:.5rem;flex-wrap:wrap"></div>
    </section>

    <section class="panel">
      <h2>Workspace</h2>
      <div class="row" style="display:flex;gap:.5rem;flex-wrap:wrap">
        <button id="lbOpen">Abrir lightbox</button>
        <label>Comparar <input id="cmpRange" type="range" min="0" max="100" value="50"/></label>
        <button id="addRect">Anotar (rect)</button>
        <button id="clearRects">Limpar anotações</button>
        <button id="exportPNG">Exportar PNG anotado</button>
        <button id="saveBundle">Guardar “bundle” (JSON)</button>
        <input id="loadBundle" type="file" accept=".json" />
      </div>
      <div class="canvas-wrap" style="position:relative;border:1px solid var(--border);border-radius:10px;overflow:hidden;background:#f1f5f9;height:540px">
        <canvas id="evCanvas" style="display:block;width:100%;height:100%"></canvas>
      </div>
      <small>Dica: a comparação usa a 1ª e a 2ª foto; as anotações servem para redacção/realce.</small>
    </section>

    <section class="panel">
      <h2>Checklist forense</h2>
      <div class="checkboxes" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:.35rem">
        <label><input type="checkbox" id="chk_rebites"> Rebites inconsistentes/añadidos</label>
        <label><input type="checkbox" id="chk_solda"> Cordões de solda anómalos</label>
        <label><input type="checkbox" id="chk_placa"> Placa remarcada/substituída</label>
        <label><input type="checkbox" id="chk_tinta"> Camadas de tinta/abrasões</label>
        <label><input type="checkbox" id="chk_etq"> Etiqueta adulterada/ausente (motor)</label>
        <label><input type="checkbox" id="chk_core"> Core plug danificado/removido (motor)</label>
        <label><input type="checkbox" id="chk_boss"> Solda/corrosão anómala no boss (motor)</label>
        <label><input type="checkbox" id="chk_bloco"> Remarcação no bloco (motor)</label>
      </div>
      <label>Notas</label>
      <textarea id="notes" rows="4" placeholder="Observações técnicas…" style="width:100%;border:1px solid var(--border);border-radius:10px;padding:.5rem .6rem;background:#fff"></textarea>
    </section>
  </main>

  <footer class="footer" style="border-top:1px solid var(--border);padding:1rem;opacity:.85;background:var(--bg-elev)">IDMAR — Identificação Marítima</footer>

  <div class="lightbox" id="lightbox" style="position:fixed;inset:0;background:rgba(15,23,42,.85);display:none;align-items:center;justify-content:center;z-index:50">
    <img id="lbImg" alt="" style="max-width:90vw;max-height:90vh;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.5)"/>
  </div>

  <!-- (limpo) removido idmar-layout.r3c.js -->
  <script src="js/forense-r1.js?v=r1"></script>
<script defer src="js/forense-i18n.v3.1.js"></script>
<!-- IDMAR Forense i18n v3.1 inline -->
<script>
(function(w,d){
  var MAP=[
    ['Abrir lightbox','Open lightbox'],
    ['Comparar','Compare'],
    ['Anotar (rect)','Annotate (rect)'],
    ['Limpar anotações','Clear annotations'],
    ['Exportar PNG anotado','Export annotated PNG'],
    ['Guardar "bundle" (JSON)','Save "bundle" (JSON)'],
    ['Escolher ficheiro','Choose file'],
    ['Workspace','Workspace'],
    ['Checklist forense','Forensic checklist'],
    ['Anexar ao histórico mais recente','Attach to most recent history'],
    // Checklist:
    ['Rebites inconsistentes/adiados','Inconsistent/added rivets'],
    ['Cordões de solda anómalos','Anomalous weld beads'],
    ['Placa remarcada/substituída','Re-stamped/substituted plate'],
    ['Camadas de tinta/abrasões','Paint layers/abrasions'],
    ['Etiqueta adulterada/ausente (motor)','Tampered/missing label (engine)'],
    ['Core plug danificado/removido (motor)','Core plug damaged/removed (engine)'],
    ['Solda/corrosão anómala no boss (motor)','Abnormal weld/corrosion on boss (engine)'],
    ['Remarcação no bloco (motor)','Re-stamping on block (engine)'],
    ['Notas','Notes'],
    ['Observações técnicas…','Technical observations…'],
    ['Observações técnicas...','Technical observations...']
  ];
  function bilingual(t){return t && t.indexOf(' / ')>=0;}
  function xlate(t){t=(t||'').trim(); for(var i=0;i<MAP.length;i++){if(t.toLowerCase()===MAP[i][0].toLowerCase())return MAP[i][0]+' / '+MAP[i][1];} return null;}
  function apply(){
    ['h1','h2','h3','legend','label','th','button','.btn'].forEach(function(sel){
      Array.from(d.querySelectorAll(sel)).forEach(function(el){
        var t=(el.textContent||'').trim(); if(!t || bilingual(t)) return;
        var tx=xlate(t); if(tx) el.textContent=tx;
      });
    });
    Array.from(d.querySelectorAll('input[type="button"],input[type="submit"]')).forEach(function(el){
      var v=(el.value||'').trim(); if(!v || bilingual(v)) return; var tx=xlate(v); if(tx) el.value=tx;
    });
    Array.from(d.querySelectorAll('textarea')).forEach(function(el){
      var ph=el.getAttribute('placeholder'); if(!ph || bilingual(ph)) return; var tx=xlate(ph); if(tx) el.setAttribute('placeholder',tx);
    });
  }
  if(d.readyState!=='loading') apply(); else d.addEventListener('DOMContentLoaded', apply);
})(window,document);
</script>

  
</body>
</html>
