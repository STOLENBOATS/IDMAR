<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IDMAR — Login</title>
  <link rel="icon" href="img/logo-pm.png" />
  <link rel="apple-touch-icon" href="img/logo-pm.png" />
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#0b6bcb">
  <link rel="stylesheet" href="css/styles.css">
  <style>
    :root{--bg:#f8fafc;--fg:#0f172a;--border:#e5e7eb}
    html,body{height:100%}
    body{background:var(--bg);color:var(--fg);margin:0;display:grid;place-items:center;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif}
    .card{width:min(480px,92vw);border:1px solid var(--border);border-radius:14px;background:#fff;box-shadow:0 6px 24px rgba(0,0,0,.06)}
    header{display:flex;gap:.75rem;align-items:center;padding:1rem;border-bottom:1px solid var(--border)}
    header img{width:40px;height:40px;object-fit:contain;opacity:.9}
    header h1{font-size:1.1rem;margin:.1rem 0}
    .lang{margin-left:auto}
    main{padding:1rem}
    .field{display:flex;flex-direction:column;gap:.35rem;margin:.65rem 0}
    label{font-weight:600}
    input{padding:.6rem .7rem;border:1px solid var(--border);border-radius:.55rem}
    button{width:100%;padding:.75rem;border:1px solid var(--border);border-radius:.65rem;background:#0b6bcb;color:#fff;font-weight:600;cursor:pointer}
    .hint{font-size:.9rem;opacity:.8;margin-top:.5rem}
    footer{padding:.9rem 1rem;border-top:1px solid var(--border);font-size:.85rem;opacity:.8}
  </style>
</head>
<body>
  <div class="card">
    <header>
      <img src="img/logo-pm.png" alt="Polícia Marítima" />
      <div>
        <h1>IDMAR — Acesso</h1>
        <div class="subtitle" style="font-size:.85rem;opacity:.75">Identificação Marítima • Cascos &amp; Motores</div>
      </div>
      <div class="lang">
        <select id="langLogin">
          <option value="pt">PT</option>
          <option value="en">EN</option>
        </select>
      </div>
    </header>
    <main>
      <div class="field">
        <label for="user" data-i18n="login.user">Utilizador</label>
        <input id="user" autocomplete="username" placeholder="admin" />
      </div>
      <div class="field">
        <label for="pass" data-i18n="login.pass">Password</label>
        <input id="pass" type="password" autocomplete="current-password" placeholder="Admin2025" />
      </div>
      <button id="btnLogin" data-i18n="login.btn">Entrar</button>
      <div class="hint" id="loginHint">Credenciais demo: <code>admin</code> / <code>Admin2025</code></div>
    </main>
    <footer>
      IDMAR — Login • <span>v4.2.1-auth-min — 2025-10-15</span>
    </footer>
  </div>

  <script>
    const sel = document.getElementById('langLogin');
    const saved = localStorage.getItem('IDMAR_LANG') || 'pt';
    sel.value = saved; localStorage.setItem('IDMAR_LANG', saved);
    const t = {
      pt:{ 'login.user':'Utilizador','login.pass':'Password','login.btn':'Entrar' },
      en:{ 'login.user':'Username','login.pass':'Password','login.btn':'Sign in' }
    };
    function applyLoginLang(lang){
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const k = el.getAttribute('data-i18n');
        if (t[lang] && t[lang][k]) el.textContent = t[lang][k];
      });
      localStorage.setItem('IDMAR_LANG', lang);
    }
    sel.addEventListener('change', e=> applyLoginLang(e.target.value));
    applyLoginLang(saved);

    function setSession(user){
      const sess = { user, role:'operator', ts: Date.now() };
      localStorage.setItem('IDMAR_SESSION', JSON.stringify(sess));
    }
    document.getElementById('btnLogin').addEventListener('click', ()=>{
      const u = document.getElementById('user').value.trim();
      const p = document.getElementById('pass').value;
      if (u.toLowerCase()==='admin' && p==='Admin2025'){ setSession(u); location.href = 'validador.html'; }
      else { alert(saved==='en' ? 'Invalid credentials' : 'Credenciais inválidas'); }
    });
    document.getElementById('pass').addEventListener('keydown', (e)=>{ if(e.key==='Enter') document.getElementById('btnLogin').click(); });
  </script>
</body>
</html>
